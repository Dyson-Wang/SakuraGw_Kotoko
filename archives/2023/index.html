<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>樱川琴子的 备忘录</title><meta name="author" content="Dyson Wang"><link rel="shortcut icon" href="/SakuraGw_Kotoko/img/favicon.png"><link rel="stylesheet" href="/SakuraGw_Kotoko/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/SakuraGw_Kotoko/atom.xml" title="樱川琴子的 备忘录" type="application/atom+xml">
</head><body><header id="page_header"><div class="header_wrap"><div id="blog_name"><a class="blog_title" id="site-name" href="/SakuraGw_Kotoko/">樱川琴子的 备忘录</a></div><button class="menus_icon"><div class="navicon"></div></button><ul class="menus_items"><li class="menus_item"><a class="site-page" href="/SakuraGw_Kotoko/#Publications"> Publications</a></li><li class="menus_item"><a class="site-page" href="/SakuraGw_Kotoko/"> About</a></li><li class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://phower.me"> Blog</a></li></ul></div></header><main id="page_main"><div class="side-card sticky"><div class="card-wrap" itemscope itemtype="http://schema.org/Person"><div class="author-avatar"><img class="avatar-img" src="/SakuraGw_Kotoko/img/avatar.png" onerror="this.onerror=null;this.src='/SakuraGw_Kotoko/img/profile.png'" alt="avatar"></div><div class="author-discrip"><h3>Dyson Wang</h3><p class="author-bio">Your biography can be writed down here.</p></div><div class="author-links"><button class="btn m-social-links">Links</button><ul class="social-icons"><li><a class="social-icon" href="/" target="_blank"><i class="fab fa-twitter" aria-hidden="true"></i></a></li><li><a class="social-icon" href="/" target="_blank"><i class="fab fa-facebook-square" aria-hidden="true"></i></a></li><li><a class="social-icon" href="/" target="_blank"><i class="fab fa-github" aria-hidden="true"></i></a></li><li><a class="social-icon" href="/" target="_blank"><i class="fab fa-stack-overflow" aria-hidden="true"></i></a></li><li><a class="social-icon" href="/" target="_blank"><i class="fab fa-linkedin" aria-hidden="true"></i></a></li><li><a class="social-icon" href="/" target="_blank"><i class="fab fa-weibo" aria-hidden="true"></i></a></li><li><a class="social-icon" href="/" target="_blank"><i class="fab fa-weixin" aria-hidden="true"></i></a></li><li><a class="social-icon" href="/" target="_blank"><i class="fab fa-qq" aria-hidden="true"></i></a></li><li><a class="social-icon" href="/" target="_blank"><i class="fas fa-envelope" aria-hidden="true"></i></a></li><li><a class="social-icon" href="/" target="_blank"><i class="fas fa-rss" aria-hidden="true"></i></a></li></ul><ul class="social-links"><li><a class="e-social-link" href="/SakuraGw_Kotoko/" target="_blank"><i class="fas fa-graduation-cap" aria-hidden="true"></i><span>Google Scholar</span></a></li><li><a class="e-social-link" href="/SakuraGw_Kotoko/" target="_blank"><i class="fab fa-orcid" aria-hidden="true"></i><span>ORCID</span></a></li></ul></div><a class="cv-links" href="/SakuraGw_Kotoko/attaches/CV.pdf" target="_blank"><i class="fas fa-file-pdf" aria-hidden="true"><span>My Detail CV.</span></i></a></div></div><div class="page" itemscope itemtype="http://schema.org/CreativeWork"><article><h1 id="openmp"><a href="#openmp" class="headerlink" title="openmp"></a>openmp</h1><h2 id="p"><a href="#p" class="headerlink" title="-p"></a>-p</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1. 90-1000-146146</span><br><span class="line">2. 121-1000-204525</span><br><span class="line">3. 52-1000-60153</span><br><span class="line">4. 36-1000-61632</span><br><span class="line">5. 88-1000-174049</span><br><span class="line">6. 170-171-205061</span><br><span class="line">7. 144-145-235589</span><br><span class="line">8. 198-199-371482</span><br></pre></td></tr></table></figure>

<h2 id="c"><a href="#c" class="headerlink" title="-c"></a>-c</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. 143-21-13752</span><br><span class="line">2. 106-27-6851</span><br><span class="line">3. 181-21-20332</span><br><span class="line">4. 73-20-3250</span><br><span class="line">5. 163-30-18056</span><br></pre></td></tr></table></figure>
</article><article><h1 id="Gem5"><a href="#Gem5" class="headerlink" title="Gem5"></a>Gem5</h1></article><article><h1 id="mariadb"><a href="#mariadb" class="headerlink" title="mariadb"></a>mariadb</h1><h2 id="install"><a href="#install" class="headerlink" title="install"></a>install</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y mariadb-server</span><br><span class="line"></span><br><span class="line">sudo systemctl status mariadb</span><br><span class="line"></span><br><span class="line">sudo systemctl start mariadb</span><br><span class="line"></span><br><span class="line">sudo systemctl enable mariadb</span><br><span class="line"></span><br><span class="line">sudo mysql_secure_installation</span><br><span class="line"></span><br><span class="line">sudo mysql</span><br></pre></td></tr></table></figure>
</article><article><h1 id="Https-Notes"><a href="#Https-Notes" class="headerlink" title="Https Notes"></a>Https Notes</h1><h2 id="虚构一个CA机构"><a href="#虚构一个CA机构" class="headerlink" title="虚构一个CA机构"></a>虚构一个CA机构</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 生成CA认证机构的证书密钥key</span><br><span class="line"># 需要设置密码，输入两次</span><br><span class="line">openssl genrsa -des3 -out ca.key 2048</span><br><span class="line"></span><br><span class="line"># 去除密钥里的密码(可选)</span><br><span class="line"># 这里需要再输入一次原来设的密码</span><br><span class="line">openssl rsa -in ca.key -out ca.key</span><br><span class="line"></span><br><span class="line"># 用私钥ca.key生成CA认证机构的证书ca.crt</span><br><span class="line"># 其实就是相当于用私钥生成公钥，再把公钥包装成证书</span><br><span class="line">openssl req -new -x509 -key ca.key -out ca.crt -days 3650</span><br><span class="line"># 这个证书ca.crt有的又称为&quot;根证书&quot;,因为可以用来认证其他证书</span><br></pre></td></tr></table></figure>

<h2 id="生成网站的证书"><a href="#生成网站的证书" class="headerlink" title="生成网站的证书"></a>生成网站的证书</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 生成自己网站的密钥server.key</span><br><span class="line">openssl genrsa -des3 -out server.key 2048</span><br><span class="line"></span><br><span class="line"># 生成自己网站证书的请求文件</span><br><span class="line"># 如果找外面的CA机构认证，也是发个请求文件给他们</span><br><span class="line"># 这个私钥就包含在请求文件中了，认证机构要用它来生成网站的公钥，然后包装成一个证书</span><br><span class="line">openssl req -new -key server.key -out server.csr</span><br><span class="line"></span><br><span class="line"># 使用虚拟的CA认证机构的证书ca.crt，来对自己网站的证书请求文件server.csr进行处理，生成签名后的证书server.crt</span><br><span class="line"># 注意设置序列号和有效期（一般都设1年）</span><br><span class="line">openssl x509 -req -in server.csr -CA ca.crt -CAkey ca.key -set_serial 01 -out server.crt -days 365</span><br><span class="line"></span><br><span class="line">// set_serial指定生成的自签名根证书的序列号，默认情况下生成的自签名根证书序列号是0；该选项也只有在生成自签名根证书的时候有效。</span><br></pre></td></tr></table></figure>

<h2 id="配置nginx"><a href="#配置nginx" class="headerlink" title="配置nginx"></a>配置nginx</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">把server.crt 和server.key 文件放在nginx/conf文件夹下。(和nginx.conf文件同一文件夹)</span><br><span class="line"> </span><br><span class="line">ssl_certificate server.crt;</span><br><span class="line">ssl_certificate_key server.key;</span><br><span class="line"></span><br><span class="line">/443 搜索 注释</span><br></pre></td></tr></table></figure>
<h2 id="windows-hosts配置"><a href="#windows-hosts配置" class="headerlink" title="windows hosts配置"></a>windows hosts配置</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\System32\drivers\etc\hosts</span><br></pre></td></tr></table></figure>
</article><article><h1 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h1><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><ul>
<li>git</li>
<li>nodejs</li>
<li>docker</li>
<li>kubernetes</li>
<li>ngnix</li>
<li>mariadb</li>
<li>gitlab</li>
<li>github</li>
</ul>
</article><article><h1 id="rocky-logs"><a href="#rocky-logs" class="headerlink" title="rocky logs"></a>rocky logs</h1><h2 id="安装环境"><a href="#安装环境" class="headerlink" title="安装环境"></a>安装环境</h2><ul>
<li><p>切换yum源nju mirror</p>
</li>
<li><p>安装net-tools</p>
</li>
<li><p>git 2.39.1</p>
</li>
<li><p>tar 1.34</p>
</li>
<li><p>手动全局安装nodejs</p>
</li>
<li><p>配置npm mirror</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm get registry</span><br><span class="line">npm config set registry https://registry.npmmirror.com</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yarn config get registry</span><br><span class="line">yarn config set registry https://registry.npmmirror.com</span><br></pre></td></tr></table></figure>

</li>
<li><p>yum-utils</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y yum-utils</span><br><span class="line"></span><br><span class="line">sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure></li>
<li><p>docker</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin -y</span><br><span class="line"></span><br><span class="line">systemctl start docker</span><br><span class="line"></span><br><span class="line">systemctl enable docker</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// /etc/docker/daemon.json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;registry-mirrors&quot;: [</span><br><span class="line">        &quot;https://24fgpaf5.mirror.aliyuncs.com&quot;,</span><br><span class="line">        &quot;https://83f60d800b31479a97ed45ce119dab75.mirror.swr.myhuaweicloud.com&quot;,</span><br><span class="line">        &quot;https://hub-mirror.c.163.com&quot;,</span><br><span class="line">        &quot;https://docker.mirrors.ustc.edu.cn&quot;,</span><br><span class="line">        &quot;https://mirror.baidubce.com&quot;,</span><br><span class="line">        &quot;https://reg-mirror.qiniu.com&quot;,</span><br><span class="line">        &quot;https://mirror.ccs.tencentyun.com&quot;,</span><br><span class="line">        &quot;https://registry.docker-cn.com&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker</span><br><span class="line">docker info</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="softwares"><a href="#softwares" class="headerlink" title="softwares"></a>softwares</h1><h2 id="gitlab"><a href="#gitlab" class="headerlink" title="gitlab"></a>gitlab</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">docker pull gitlab/gitlab-ce</span><br><span class="line">docker images</span><br><span class="line"></span><br><span class="line">docker run --detach \</span><br><span class="line">  --publish 16443:443 --publish 16680:80 --publish 16622:22 \</span><br><span class="line">  --name gitlab \</span><br><span class="line">  --restart always \</span><br><span class="line">  --volume $GITLAB_HOME/config:/etc/gitlab:Z \</span><br><span class="line">  --volume $GITLAB_HOME/logs:/var/log/gitlab:Z \</span><br><span class="line">  --volume $GITLAB_HOME/data:/var/opt/gitlab:Z \</span><br><span class="line">  gitlab/gitlab-ce</span><br><span class="line"></span><br><span class="line">docker run </span><br><span class="line">  -d</span><br><span class="line">  -p 443:443 -p 9000:80 -p 22:22 //外：内</span><br><span class="line">  --name gitlab</span><br><span class="line">  --restart always</span><br><span class="line">  -v $HOME/docker/gitlab/config:/etc/gitlab</span><br><span class="line">  -v $HOME/docker/gitlab/logs:/var/log/gitlab</span><br><span class="line">  -v $HOME/docker/gitlab/data:/var/opt/gitlab</span><br><span class="line">  gitlab/gitlab-ce</span><br><span class="line"></span><br><span class="line"># -d：后台运行</span><br><span class="line"># -p：将容器内部端口向外映射</span><br><span class="line"># --name：命名容器名称</span><br><span class="line"># -v：将容器内数据文件夹或者日志、配置等文件夹挂载到宿主机指定目录</span><br><span class="line"></span><br><span class="line"># 443:443：将http：443映射到外部端口443</span><br><span class="line"># 9000:80：将web：80映射到外部端口9000</span><br><span class="line"># 22:22：将ssh：22映射到外部端口22</span><br><span class="line"></span><br><span class="line">port 8888 root 15630148029</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="nginx-usr-local-nginx"><a href="#nginx-usr-local-nginx" class="headerlink" title="nginx &#x2F;usr&#x2F;local&#x2F;nginx"></a>nginx &#x2F;usr&#x2F;local&#x2F;nginx</h2></article><article><h1 id="docker-in-rocky"><a href="#docker-in-rocky" class="headerlink" title="docker in rocky"></a>docker in rocky</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y yum-utils</span><br><span class="line">sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line"></span><br><span class="line">yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line">yum install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// daemon.json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;registry-mirrors&quot;: [</span><br><span class="line">        &quot;https://24fgpaf5.mirror.aliyuncs.com&quot;,</span><br><span class="line">        &quot;https://83f60d800b31479a97ed45ce119dab75.mirror.swr.myhuaweicloud.com&quot;,</span><br><span class="line">        &quot;https://hub-mirror.c.163.com&quot;,</span><br><span class="line">        &quot;https://docker.mirrors.ustc.edu.cn&quot;,</span><br><span class="line">        &quot;https://mirror.baidubce.com&quot;,</span><br><span class="line">        &quot;https://reg-mirror.qiniu.com&quot;,</span><br><span class="line">        &quot;https://mirror.ccs.tencentyun.com&quot;,</span><br><span class="line">        &quot;https://registry.docker-cn.com&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker</span><br><span class="line">docker info</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo dnf check-update</span><br><span class="line">sudo dnf config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line">sudo dnf install docker-ce docker-ce-cli containerd.io -y</span><br><span class="line">sudo systemctl start docker</span><br><span class="line">sudo systemctl status docker</span><br><span class="line">sudo systemctl enable docker</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql:latest</span><br><span class="line">docker images</span><br><span class="line">docker ps -a</span><br><span class="line"></span><br><span class="line">docker run -itd --name mysql-test -p 3306:3306 -e MYSQL_ROOT_PASSWORD=123456 mysql</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>-i 以交互模式运行容器，通常与 -t 同时使用<br>-t 为容器重新分配一个伪输入终端，通常与 -i 同时使用<br>-d 后台运行容器，并返回容器ID<br>–name&#x3D;”nginx-lb”: 为容器指定一个名称<br>-e username&#x3D;”ritchie”: 设置环境变量<br>-p: 指定端口映射，格式为：主机(宿主)端口:容器端口</p>
<h2 id="drone"><a href="#drone" class="headerlink" title="drone"></a>drone</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">docker run</span><br><span class="line">  --volume=/srv/drone:/data</span><br><span class="line">  --env=DRONE_GITLAB_SERVER=HTTP://192.168.1.104:8888</span><br><span class="line">  --env=DRONE_GITLAB_CLIENT_ID=b19a3167484bf0d283e16a57b4f4e31e63617b48ebf4fc1714a2078eecaef00c</span><br><span class="line">  --env=DRONE_GITLAB_CLIENT_SECRET=56bba1c6fa31998b6e0923c54300f60ba513b9ffcdc41696c258975ff1537f54</span><br><span class="line">  --env=DRONE_RPC_SECRET=323c3689a93a2853c38b28e78736a482</span><br><span class="line">  --env=DRONE_SERVER_HOST=192.168.1.104</span><br><span class="line">  --env=DRONE_SERVER_PROTO=http</span><br><span class="line">  --publish=32222:80</span><br><span class="line">  --publish=32221:443</span><br><span class="line">  --restart=always</span><br><span class="line">  --detach=true</span><br><span class="line">  --name=drone</span><br><span class="line">  drone/drone:latest</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">version: &#x27;3.9&#x27;</span><br><span class="line"># 创建自定义网络</span><br><span class="line">networks:</span><br><span class="line">  drone:</span><br><span class="line">    name: drone</span><br><span class="line">    driver: bridge</span><br><span class="line">services:</span><br><span class="line">  # 数据库服务</span><br><span class="line">  db:</span><br><span class="line">    image: postgres:latest</span><br><span class="line">    container_name: drone_db</span><br><span class="line">    restart: always</span><br><span class="line">    networks:</span><br><span class="line">      - drone # 加入到drone网络</span><br><span class="line">    ports:</span><br><span class="line">      - &#x27;32000:5432&#x27;</span><br><span class="line">    environment:</span><br><span class="line">      - POSTGRES_USER=drone # PGSQL默认用户</span><br><span class="line">      - POSTGRES_PASSWORD=drone # PGSQL默认密码</span><br><span class="line">      - POSTGRES_DB=drone # PGSQL默认数据库</span><br><span class="line">    volumes:</span><br><span class="line">      - /srv/drone/db:/var/lib/postgresql/data</span><br><span class="line">  # Drone Server 服务</span><br><span class="line">  server:</span><br><span class="line">    image: drone/drone:latest # 目前drone最新版本为 2.8.0</span><br><span class="line">    container_name: drone_server</span><br><span class="line">    restart: always</span><br><span class="line">    networks:</span><br><span class="line">      - drone # 加入到drone网络</span><br><span class="line">    ports:</span><br><span class="line">      - &#x27;32222:80&#x27;</span><br><span class="line">    environment:</span><br><span class="line">      - DRONE_SERVER_PROTO=http # 访问协议，创建webHooks和重定向</span><br><span class="line">      - DRONE_SERVER_HOST=192.168.1.104:32222 # 主机名称，创建webHooks和重定向</span><br><span class="line">      - DRONE_RPC_SECRET=323c3689a93a2853c38b28e78736a482 # 与 drone runner 通讯的密钥</span><br><span class="line">      - DRONE_USER_CREATE=username:root,admin:true # 管理员账户</span><br><span class="line">      - DRONE_DATABASE_DRIVER=postgres # 数据库类型</span><br><span class="line">      - DRONE_DATABASE_DATASOURCE=postgres://drone:drone@db/drone?sslmode=disable # 数据库连接</span><br><span class="line">      - DRONE_GIT_ALWAYS_AUTH=true # 使用 oauth 身份验证信息拉取代码</span><br><span class="line">      - DRONE_GITLAB_SERVER=HTTP://192.168.1.104:8888</span><br><span class="line">      - DRONE_GITLAB_CLIENT_ID=b19a3167484bf0d283e16a57b4f4e31e63617b48ebf4fc1714a2078eecaef00c</span><br><span class="line">      - DRONE_GITLAB_CLIENT_SECRET=56bba1c6fa31998b6e0923c54300f60ba513b9ffcdc41696c258975ff1537f54</span><br><span class="line">    volumes:</span><br><span class="line">      - /srv/drone/server:/data</span><br><span class="line">      - /var/run/docker.sock:/var/run/docker.sock</span><br><span class="line">    depends_on:</span><br><span class="line">      - db</span><br><span class="line">  # Drone Docker Runner</span><br><span class="line">  runner:</span><br><span class="line">    image: drone/drone-runner-docker:latest # 目前drone-runner-docker最新版本为 1.8.0</span><br><span class="line">    container_name: drone_runner</span><br><span class="line">    restart: always</span><br><span class="line">    networks:</span><br><span class="line">      - drone # 加入到drone网络</span><br><span class="line">    ports:</span><br><span class="line">      - &#x27;32220:3000&#x27;</span><br><span class="line">    environment:</span><br><span class="line">      - DRONE_RUNNER_NAME=docker-runner</span><br><span class="line">      - DRONE_RUNNER_CAPACITY=10 # 限制runner可执行的并发管道数量</span><br><span class="line">      - DRONE_RPC_PROTO=http # 访问drone server 协议</span><br><span class="line">      - DRONE_RPC_HOST=192.168.1.104:32222 # 访问drone server 服务器地址</span><br><span class="line">      - DRONE_RPC_SECRET=e1ad8a7f3dbc68ca9c21bcc949335009 # 与 drone server 通讯的密钥</span><br><span class="line">      - DRONE_UI_USERNAME=root # Drone Runner 的 UI 用户账号</span><br><span class="line">      - DRONE_UI_PASSWORD=8888 # Drone Runner 的 UI 用户密码</span><br><span class="line">    volumes:</span><br><span class="line">      - &#x27;/var/run/docker.sock:/var/run/docker.sock&#x27;</span><br><span class="line">    depends_on:</span><br><span class="line">      - server</span><br></pre></td></tr></table></figure>
</article><article><h1 id="mac"><a href="#mac" class="headerlink" title="mac"></a>mac</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python macrecovery.py -b Mac-4B682C642B45593E -m 00000000000000000 download</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c:\&quot;Program Files&quot;\qemu\qemu-img convert -O vmdk -o compat6 BaseSystem.dmg recovery.vmdk</span><br></pre></td></tr></table></figure>

<p>.vmx </p>
<p>ethenet0 &#x3D; “vmxnet3”</p>
</article><article><h1 id="Logs"><a href="#Logs" class="headerlink" title="Logs"></a>Logs</h1><ul>
<li>安装 net-tools</li>
<li>安装 git</li>
<li>安装 nodejs</li>
<li>安装 mariadb-server</li>
<li>mysql_secure_installation 00125</li>
<li></li>
</ul>
</article><article><h1 id="BND"><a href="#BND" class="headerlink" title="BND"></a>BND</h1><p>设每个用户下每个命名空间，可以单独配置一个数据库用于所建云函数的链接。</p>
<h3 id="新建函数"><a href="#新建函数" class="headerlink" title="新建函数"></a>新建函数</h3><p>API种类<br>1、数据库交互<br>2、静态资源上传与请求<br>3、函数内运算响应</p>
<p>沙箱逃逸</p>
<p>vm</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const vm = require(&#x27;vm&#x27;);</span><br><span class="line">vm.runInNewContext(&#x27;this.constructor.constructor(&quot;return process&quot;)().exit()&#x27;);</span><br><span class="line">console.log(&#x27;Never gets executed.&#x27;);</span><br></pre></td></tr></table></figure>
<p>vm2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const &#123;VM&#125; = require(&#x27;vm2&#x27;);</span><br><span class="line">new VM().run(&#x27;this.constructor.constructor(&quot;return process&quot;)().exit()&#x27;);</span><br><span class="line">// Throws ReferenceError: process is not defined</span><br></pre></td></tr></table></figure>

<h1 id="API"><a href="#API" class="headerlink" title="API"></a>API</h1><h2 id="func部分"><a href="#func部分" class="headerlink" title="func部分"></a>func部分</h2><h3 id="调用函数-GET方法"><a href="#调用函数-GET方法" class="headerlink" title="调用函数(GET方法)"></a>调用函数(GET方法)</h3><p><strong>GET</strong> <em>&#x2F;faas&#x2F;:id</em></p>
<p><strong>return</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  //标准返回对象</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="调用函数-POST方法"><a href="#调用函数-POST方法" class="headerlink" title="调用函数(POST方法)"></a>调用函数(POST方法)</h3><p><strong>POST</strong> <em>&#x2F;faas&#x2F;:id</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  //示例对象</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>return</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  //标准返回对象</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="backend部分"><a href="#backend部分" class="headerlink" title="backend部分"></a>backend部分</h2><h3 id="添加函数"><a href="#添加函数" class="headerlink" title="添加函数"></a>添加函数</h3><p><strong>POST</strong> <em>&#x2F;addfunc</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  user-token,</span><br><span class="line">  codeStr:String, //代码字符串</span><br><span class="line">  method:String, //函数方法</span><br><span class="line">  objScan:Object, //输入实例对象</span><br><span class="line">  comment:String, //函数功能备注</span><br><span class="line">  maxruntime</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>return</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  status,</span><br><span class="line">  message,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="请求函数列表"><a href="#请求函数列表" class="headerlink" title="请求函数列表"></a>请求函数列表</h3><h4 id="用户下全部函数"><a href="#用户下全部函数" class="headerlink" title="用户下全部函数"></a>用户下全部函数</h4><p><strong>GET</strong> <em>&#x2F;funclist</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user-token</span><br></pre></td></tr></table></figure>

<p><strong>return</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  funcarray:Array[&#123;</span><br><span class="line">      functionid,</span><br><span class="line">      createTime,</span><br><span class="line">      invokeTimes,</span><br><span class="line">      namespaceid,</span><br><span class="line">      master,</span><br><span class="line">      ...</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="命名空间下全部函数"><a href="#命名空间下全部函数" class="headerlink" title="命名空间下全部函数"></a>命名空间下全部函数</h4><p><strong>GET</strong> <em>&#x2F;funclist&#x2F;:namespaceid</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user-token</span><br></pre></td></tr></table></figure>

<p><strong>return</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  funcarray:Array[&#123;</span><br><span class="line">      functionid,</span><br><span class="line">      createTime,</span><br><span class="line">      invokeTimes,</span><br><span class="line">      namespaceid,</span><br><span class="line">      master,</span><br><span class="line">      ...</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</article></div></main><div class="nav-wrap"><div class="nav"><button class="site-nav"><div class="navicon"></div></button><ul class="nav_items"><li class="nav_item"><a class="nav-page" href="/SakuraGw_Kotoko/#Publications"> Publications</a></li><li class="nav_item"><a class="nav-page" href="/SakuraGw_Kotoko/"> About</a></li><li class="nav_item"><a class="nav-page" target="_blank" rel="noopener" href="https://phower.me"> Blog</a></li></ul></div><div class="cd-top"><i class="fa fa-arrow-up" aria-hidden="true"></i></div></div><footer id="page_footer"><div class="footer_wrap"><div class="copyright">&copy;2020 - 2024 by Dyson Wang</div><div class="theme-info">Powered by <a target="_blank" href="https://hexo.io" rel="nofollow noopener">Hexo</a> & <a target="_blank" href="https://github.com/PhosphorW/hexo-theme-academia" rel="nofollow noopener">Academia Theme</a></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery-pjax@latest/jquery.pjax.min.js"></script><script src="/SakuraGw_Kotoko/js/main.js"></script></body></html>